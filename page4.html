<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.rawgit.com/Keyang/node-csvtojson/d41f44aa/browser/csvtojson.min.js"></script>
    <title>Adult Por(love)n</title>
    <link rel="icon" href="https://i.pinimg.com/564x/6f/b1/fa/6fb1fa3c16a2aa37a4ab3d7e192b7c2d.jpg">
</head>
<body>
    <div id="head">
    <div id="content" style="border: solid black; position: sticky; top: 0px; background-color: white;">
        Choose the Topic.<select id="topic" style="width: 200px;" onchange="build(this)"><option>-</option></select><br>
    </div>
    <div id="show" style="width: 310px; font-size:0; margin-left: auto; margin-right: auto;"></div>
    <footer>
        <br>Â© 2024 Manhtia.porn Website source reserves to Manhtia.porn, Contents credit to owner.<br>
    </footer>
</body>
<script>
    /*
        type- 
            0 = img
            1 = video
            2 = html
    */
   //replace RPSID with sheet id, RPSNM with sheet name
   const api = "https://script.google.com/macros/s/AKfycbwPyo50dXb4y5r4H2B0fLEVqpWKhWo58g_YmKna1cnlesJ96RhixlmQiwItAuLcuF0XbQ/exec?q=";
   const idList = "1eN-r-dTjK8ZbtjLU2KRPWSUiuDXNj2iV2jBXthcMzCI";
   var conveyList;
   var name_pop = [];

   //to read all id availiable
    fetch(api + idList + "&p=Sheet1").then(data => data.json()).then(data => {

        conveyList = data;
        var datalist = document.getElementById("topic");

        for(var o = 0; o < conveyList.length; o++){

            if(!name_pop.includes(data[o].Topic)){
                const option = document.createElement('option');
                option.text = data[o].Topic;
                option.value = data[o].Topic;
                datalist.appendChild(option);
                name_pop.push(data[o].Topic);
            }
            
        }

    })

    function build(e){
        document.getElementById("show").innerHTML = "";
        for(var i = 0; i < conveyList.length; i++){

            if(conveyList[i].Topic == e.value){

                switch(conveyList[i].Type){
                    case 0: 
                        var img = document.createElement('img');
                        img.setAttribute('src', conveyList[i].HTML);
                        img.style.width = "300px";
                        document.getElementById("show").appendChild(img);
                        break;
                    case 1: 
                        var x = document.createElement("VIDEO");

                        if (x.canPlayType("video/mp4")) {
                            x.setAttribute("src", conveyList[i].HTML);
                        }

                        x.setAttribute("width", "320");
                        x.setAttribute("controls", "controls");
                        document.getElementById("show").appendChild(img);
                        break;
                    case 2: 
                        var html = document.createElement('div');
                        html.innerHTML = conveyList[i].HTML;
                        html.style.width = "300px";
                        document.getElementById("show").appendChild(html);
                        break;
                }

                var div = document.createElement("div");
                div.innerHTML = conveyList[i].Source;
                document.getElementById("show").appendChild(div);

            }

        }

    }
   
</script>
</html>
